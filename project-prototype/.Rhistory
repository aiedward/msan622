p1
p1<-ggplot(gain_cost)+geom_line(aes(x=Year,y=value, col=variable),size=2)
p1<-p1+scale_x_discrete(labels=Year)+scale_y_continuous(expand=c(0,NA),label = thousand_formatter)
p1<-p1+labs(title="Gain and Cost", x="YEAR",y="Gain/Cost in Euro (K)")
p1
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p1<-ggplot(gain_cost)+geom_line(aes(x=Year,y=value, col=variable),size=2)
p1<-p1+scale_x_discrete(labels=Year)+scale_y_continuous(expand=c(0,20000),label = thousand_formatter)
p1<-p1+labs(title="Gain and Cost", x="YEAR",y="Gain/Cost in Euro (K)")
p1<-p1+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_line(color="gray",size=0.5),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p1
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p1<-ggplot(gain_cost)+geom_line(aes(x=Year,y=value, col=variable),size=2)
p1<-p1+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p1<-p1+labs(title="Gain and Cost", x="YEAR",y="Gain/Cost in Euro (K)")
p1<-p1+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_line(color="gray",size=0.5),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p1
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p1<-p1+labs(colour = "")
p1
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p2<-ggplot(profit)+geom_line(aes(x=Year,y=value))
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
p2<-ggplot(profit)+geom_line(aes(x=Year,y=value),col="blue")
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
p2<-ggplot(profit)+geom_line(aes(x=Year,y=value),col="blue",size=3)
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),col="blue",size=3)
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3)
p2
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3,stat="identity")
p2
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
profit
Year
Year<-colnames(sim_table)
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2
Year<-colnames(sim_table)
Year<-Year[-length(Year)]
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2
profit
profit<-melt(df1,id.vars="Year",measure.vars="profit_raw")
profit
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2
Year
p2<-p2+scale_x_discrete()+scale_y_continuous(label = thousand_formatter)
p2<-ggplot(profit)+geom_bar(aes(x=Year,y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete()+scale_y_continuous(label = thousand_formatter)
p2
p2<-ggplot(profit)+geom_bar(aes(y=value),fill="blue",size=3,stat="identity")
p2
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p2<-ggplot(profit)+geom_bar(aes(x=as.factor(Year), y=value),fill="blue",size=3,stat="identity")
p2
p2<-ggplot(profit)+geom_bar(aes(x=as.factor(Year), y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete()+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p2<-ggplot(profit)+geom_bar(aes(x=as.factor(Year), y=value),fill="blue",size=3,stat="identity")
p2<-p2+scale_x_discrete(labels=Year)+scale_y_continuous(label = thousand_formatter)
p2<-p2+labs(title="Profit/Loss", x="YEAR",y="Profit in Euro (K)")
p2<-p2+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "bottom",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
p2
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity")
p3
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity")
p3<-p3+scale_y_continuous(label = thousand_formatter)
p3<-p3+labs(title="ROI\n(Discounted PV vs Marketing Cost)", x="",y="Present Value in Euro (K)")
p3<-theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "none",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = 2)))
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity")
p3<-p3+scale_y_continuous(label = thousand_formatter)
p3<-p3+labs(title="ROI\n(Discounted PV vs Marketing Cost)", x="",y="Present Value in Euro (K)")
p3<-theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "none",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))
p3
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity")
p3<-p3+scale_y_continuous(label = thousand_formatter)
p3<-p3+labs(title="ROI\n(Discounted PV vs Marketing Cost)", x="",y="Present Value in Euro (K)")
p3<-p3+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "none",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))
p3
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity",width=.5)
p3<-p3+scale_y_continuous(label = thousand_formatter)
p3<-p3+labs(title="ROI\n(Discounted PV vs Marketing Cost)", x="",y="Present Value in Euro (K)")
p3<-p3+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(color="gray",size=0.5),
panel.grid.minor.y = element_blank(),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.position = "none",
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))
p3
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity",width=.1)
p3
p3<-ggplot(df2)+geom_bar(aes(x=variable,y=value,fill=variable),stat="identity",width=.4)
p3
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
ROI_simulation<-function(sim_timeline,
precision,
target_customer,
camp_cost,
payout_int_rate,
ave_balance,
balance_rate,
inv_int_rate,
ret_cost,
churn,
discount_rate){
timeline<- paste("YR",1:sim_timeline,sep="")
after_timeline<-paste("After_YR",sim_timeline+1,sep="")
timeline<-c(timeline,after_timeline)
customer<-rep(0,length(timeline))
customer[1]<-precision*target_customer
op_cost<-rep(0,length(timeline))
op_cost[1]<-customer[1]*ret_cost
principal<-rep(0,length(timeline))
principal[1]<-customer[1]*ave_balance*balance_rate
gain<-rep(0,length(timeline))
gain[1]<-principal[1]*inv_int_rate
payout<-rep(0,length(timeline))
payout[1]<-principal[1]*payout_int_rate
total_cost<-rep(0,length(timeline))
total_cost[1]<-op_cost[i]+payout[1]
profit_raw<-rep(0,length(timeline))
profit_raw[1]<-gain[1]-total_cost[1]
profit_disc<-rep(0,length(timeline))
profit_disc[1]<-profit_raw[1]/(1+discount_rate)
for(i in 2:(length(timeline))){
if(i==length(timeline)){
profit_disc[i]<-profit_raw[i-1]/discount_rate
}else{
customer[i]<-customer[i-1]*(1-churn)
op_cost[i]<-customer[i]*ret_cost
principal[i]<-principal[i-1]+gain[i-1]
gain[i]<-principal[i]*inv_int_rate
payout[i]<-principal[i]*payout_int_rate
total_cost[i]<-op_cost[i]+payout[i]
profit_raw[i]<-gain[i]-total_cost[i]
profit_disc[i]<-profit_raw[i]/(1+discount_rate)^i
}
}
sim_table<-as.data.frame(t(cbind(customer,principal,gain,payout,op_cost,total_cost,profit_raw,profit_disc)))
colnames(sim_table)<-timeline
return(sim_table)
}
ROI_simulation(sim_timeline=5,precision=0.65,target_customer=10000,camp_cost=100,payout_int_rate=0.01,ave_balance=1000,balance_rate=0.05,inv_int_rate=0.05,ret_cost=10,churn=0.01,discount_rate=0.1)
timeline<- paste("YR",1:sim_timeline,sep="")
after_timeline<-paste("After_YR",sim_timeline+1,sep="")
timeline<-c(timeline,after_timeline)
customer<-rep(0,length(timeline))
customer[1]<-precision*target_customer
op_cost<-rep(0,length(timeline))
op_cost[1]<-customer[1]*ret_cost
principal<-rep(0,length(timeline))
principal[1]<-customer[1]*ave_balance*balance_rate
gain<-rep(0,length(timeline))
gain[1]<-principal[1]*inv_int_rate
payout<-rep(0,length(timeline))
payout[1]<-principal[1]*payout_int_rate
total_cost<-rep(0,length(timeline))
total_cost
total_cost[1]<-op_cost[i]+payout[1]
total_cost
sim_timeline=5
precision=0.65
target_customer=10000
camp_cost=100
payout_int_rate=0.01
ave_balance=1000
balance_rate=0.05
inv_int_rate=0.05
ret_cost=10
churn=0.01
discount_rate=0.1
timeline<- paste("YR",1:sim_timeline,sep="")
after_timeline<-paste("After_YR",sim_timeline+1,sep="")
timeline<-c(timeline,after_timeline)
customer<-rep(0,length(timeline))
customer[1]<-precision*target_customer
op_cost<-rep(0,length(timeline))
op_cost[1]<-customer[1]*ret_cost
principal<-rep(0,length(timeline))
principal[1]<-customer[1]*ave_balance*balance_rate
gain<-rep(0,length(timeline))
gain[1]<-principal[1]*inv_int_rate
payout<-rep(0,length(timeline))
payout[1]<-principal[1]*payout_int_rate
total_cost<-rep(0,length(timeline))
total_cost[1]<-op_cost[i]+payout[1]
total_cost
op_cost
payout
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
runApp()
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
runApp()
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
source('~/Documents/MSAN/Data_Visalization/msan622/project-prototype/project_protype.R')
runApp()
runApp()
runApp()
runApp()
df2
df1
sim_table
row.names(sim_table)
runApp()
row.names(sim_table)<-c("# of Customer","Principal","Revenue","Interest Expense","Retention Cost","Total Cost","Cash Flow","Discounted Cash Flow")
sim_table
Year<-colnames(sim_table)
Year<-Year[-length(Year)]
sim_table<-as.data.frame(t(sim_table))
sim_table$Year<-1:dim(sim_table)[1]
df1<-sim_table[-dim(sim_table)[1],]
gain_cost<-melt(df1,id.vars="Year",measure.vars=c("Gain","Total Cost"))
profit<-melt(df1,id.vars="Year",measure.vars="Cash Flow")
df1
runApp()
gain_cost<-melt(df1,id.vars="Year",measure.vars=c("Revenue","Total Cost"))
profit<-melt(df1,id.vars="Year",measure.vars="Cash Flow")
sim_table
sim_table$"Discounted"
sim_table$"Discounted Cash Flow"
runApp()
runApp()
runApp()
runApp()
runApp()
x_idx<-which(colnames(data)==x_var)
x_var<-"age"
y_var<-"duration"
x_idx<-which(colnames(data)==x_var)
y_idx<-which(colnames(data)==y_var)
z_idx<-which(colnames(data)=="subscribed")
df_tmp<-as.data.frame(data[,c(x_idx,y_idx,z_idx)])
df_tmp[1,]
set.seed(1234)
idx<-sample(1:dim(df_tmp)[1],dim(df_tmp)[1]*sampsize)
sampsize=0.1
idx<-sample(1:dim(df_tmp)[1],dim(df_tmp)[1]*sampsize)
df<-df_tmp[idx,]
tmp_yes<-subset(df,subscribed=="yes")
tmp_no<-subset(df,subscribed=="no")
df<-rbind(tmp_no,tmp_yes)
colourList<-setNames(c("#E41A1C", "#377EB8"),levels(data$subscribed))
p<-ggplot(df)+geom_point(aes_string(x=x_var,y=y_var,col="subscribed"),alpha=alpha,size=size)
alpha=1
size=3
p<-ggplot(df)+geom_point(aes_string(x=x_var,y=y_var,col="subscribed"),alpha=alpha,size=size)
p
p<- p+annotate("rect", xmin=x_range[1], xmax=x_range[2], ymin=y_range[1], ymax=y_range[2], alpha=0.2, fill="blue")
x_range<-c(0,50)
y_range<-c(0,1000)
p<- p+annotate("rect", xmin=x_range[1], xmax=x_range[2], ymin=y_range[1], ymax=y_range[2], alpha=0.2, fill="blue")
p
p<-p+scale_x_continuous(limit=c(min(df_tmp[,1],max(df_tmp[,1]))))+scale_y_continuous(limit=c(min(df_tmp[,2],max(df_tmp[,2]))))
p
p<-p+scale_x_continuous(limits=c(min(df_tmp[,1],max(df_tmp[,1]))))+scale_y_continuous(limits=c(min(df_tmp[,2],max(df_tmp[,2]))))
p<-ggplot(df)+geom_point(aes_string(x=x_var,y=y_var,col="subscribed"),alpha=alpha,size=size)
p<-p+scale_x_continuous(limits=c(min(df_tmp[,1],max(df_tmp[,1]))))+scale_y_continuous(limits=c(min(df_tmp[,2],max(df_tmp[,2]))))
p
p<-ggplot(df)+geom_point(aes_string(x=x_var,y=y_var,col="subscribed"),alpha=alpha,size=size)
p<-p+scale_x_continuous(limits=c(min(df_tmp[,1]),max(df_tmp[,1])))+scale_y_continuous(limits=c(min(df_tmp[,2]),max(df_tmp[,2])))
p
runApp()
runApp()
x_idx<-which(colnames(data)==x_var)
y_idx<-which(colnames(data)==y_var)
z_idx<-which(colnames(data)=="subscribed")
df_tmp<-as.data.frame(data[,c(x_idx,y_idx,z_idx)])
set.seed(1234)
idx<-sample(1:dim(df_tmp)[1],dim(df_tmp)[1]*sampsize)
df<-df_tmp[idx,]
tmp_yes<-subset(df,subscribed=="yes")
tmp_no<-subset(df,subscribed=="no")
df<-rbind(tmp_no,tmp_yes)
colourList<-setNames(c("#E41A1C", "#377EB8"),levels(data$subscribed))
p<-ggplot(df)+geom_point(aes_string(x=x_var,y=y_var,col="subscribed"),alpha=alpha,size=size)
p<-p+scale_x_continuous(limits=c(min(df_tmp[,1]),max(df_tmp[,1])))+scale_y_continuous(limits=c(min(df_tmp[,2]),max(df_tmp[,2])))
if(facet){
p<-p+facet_wrap(~subscribed,,ncol=1)
}
p<-p+scale_color_manual(values=colourList)
p<-p+ggtitle("Overall")
p<-p+theme(legend.position="top")
p<-p+theme(panel.background = element_rect(fill="white",colour="black"),
panel.grid.major.x = element_line(color="gray",size=0.5,linetype="dotted"),
panel.grid.minor.x = element_line(color="gray",size=0.2,linetype="dotted"),
panel.grid.major.y = element_line(color="gray",size=0.5,linetype="dotted"),
panel.grid.minor.y = element_line(color="gray",size=0.2,linetype="dotted"),
plot.title = element_text(size=20),
axis.title.x = element_text(size=16,colour="black"),
axis.title.y = element_text(size=16,colour="black"),
axis.text.y=element_text(size=14,colour="black"),
axis.text.x=element_text(size=14,colour="black"),
legend.title = element_text(size=16),
legend.text = element_text(size=14),
legend.key = element_rect(fill = "White"))+guides(colour = guide_legend(override.aes = list(size = size)))
p
p<- p+annotate("rect", xmin=x_range[1], xmax=x_range[2], ymin=y_range[1], ymax=y_range[2], alpha=0.3, fill="blue")
p
p<- p+annotate("rect", xmin=25, xmax=49, ymin=0, ymax=1000, alpha=0.3, fill="blue")
p
runApp()
runApp()
runApp()
runApp()
runApp()
